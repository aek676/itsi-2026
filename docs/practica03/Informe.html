<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Título de la nueva práctica -->
    <title>Informe: Práctica 3 de n8n</title>
    
    <!-- CSS Integrado (Formato ancho completo) -->
    <style>
        /* --- Estilos Generales (Aspecto PDF) --- */
        body {
            font-family: Georgia, "Times New Roman", Times, serif;
            line-height: 1.6;
            /* Cambiamos el fondo gris a blanco */
            background-color: #ffffff;
            color: #222;
            margin: 0;
            padding: 0;
        }

        /* --- Contenedor Principal (Simulando una hoja) --- */
        .container {
            /* Hacemos que ocupe el 100% del ancho */
            width: 100%;
            max-width: none; /* Eliminamos el ancho máximo */
            margin: 0; /* Eliminamos márgenes */
            /* Ajustamos el padding para pantallas anchas */
            padding: 40px 60px;
            background-color: #ffffff;
            /* Eliminamos los bordes y sombras de la "hoja" */
            border: none;
            box-shadow: none;
            border-radius: 0;
            /* Importante para que el padding no cause un desbordamiento horizontal */
            box-sizing: border-box; 
        }

        /* --- Encabezados --- */
        h1, h2 {
            color: #000000;
            border-bottom: 1px solid #ccc;
            padding-bottom: 8px;
        }

        h1 {
            font-size: 2.4em;
            text-align: center;
            border-bottom: none;
            margin-bottom: 10px;
        }

        h2 {
            font-size: 1.7em;
            margin-top: 35px;
        }

        /* --- Párrafos y Texto --- */
        p {
            font-size: 1.1em;
            color: #333;
        }

        /* --- Imágenes --- */
        img.screenshot {
            max-width: 100%; 
            height: auto;
            border-radius: 0;
            border: 1px solid #ddd;
            margin: 20px 0;
            box-shadow: none;
        }
        
        /* --- Autor --- */
        .autor {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <!-- Título de la Práctica 3 -->
            <h1>Práctica 3: Enrutamiento Avanzado, Fusión de Datos e Integración con Google Sheets</h1>
            <p class="autor">Realizado por: Anass El Jabiry Kaddir</p>
        </header>

        <main>
            <!-- 
              SECCIÓN DE EJERCICIO 1 (Práctica 3)
              Actualizado con el Flujo Guiado
            -->
            <section id="ejercicio-1">
                <h2>Desarrollo del Flujo de Trabajo Guiado</h2>
                
                <p>
                    El flujo de trabajo guiado de esta práctica se centra en el enrutamiento avanzado y la integración con Google Sheets. El primer paso clave es el uso de un nodo <code>Switch</code>. Este nodo se configura para inspeccionar la propiedad <code>category</code> de cada chiste (obtenido de la JokeAPI) y dividir la ejecución en tres ramas distintas: 'Programming', 'Misc' y 'Dark'.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/kgdlT0S.png" 
                     alt="Captura de pantalla del Nodo Switch">

                <p>
                    A continuación, cada rama del nodo <code>Switch</code> se conecta a un nodo <code>Google Sheets (Append)</code> independiente. Cada uno de estos nodos está configurado para escribir los datos del chiste en una hoja (pestaña) diferente dentro del mismo documento de Google Sheets. Esto permite clasificar y almacenar los datos en hojas separadas ('Programming', 'Misc', 'Dark') según la categoría.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/A1FjEx3.png" 
                     alt="Captura de pantalla de los nodos de Google Sheets">
                
                <p>
                    Después de que los datos se han escrito en Google Sheets, las tres ramas de ejecución se vuelven a unificar. Esto se logra usando un nodo <code>Merge</code>, que espera a que todas las ramas de entrada finalicen y combina los flujos de datos en uno solo para los pasos posteriores.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/oXc6iXO.png" 
                     alt="Captura de pantalla del Nodo Merge">

                <p>
                    La captura de pantalla del documento de Google Sheets muestra el resultado tangible. Se pueden ver las tres pestañas ('Programming', 'Misc', 'Dark') pobladas con los datos de los chistes que fueron enrutados a cada una de ellas por el flujo de n8n, demostrando una integración exitosa.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/w3ENxk7.png" 
                     alt="Captura de pantalla del resultado en Google Sheets">
                
                <p>
                    Finalmente, la captura del flujo de trabajo final muestra el resultado de la ejecución. Se puede observar cómo los ítems (chistes) han pasado por el <code>Switch</code>, han sido procesados por los nodos de Google Sheets y finalmente se han reunido en el nodo <code>Merge</code>, mostrando una ejecución exitosa.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/HrVPNYh.png" 
                     alt="Captura de pantalla del resultado del workflow">
            </section>

            <!-- 
              SECCIÓN DE EJERCICIO 2 (Práctica 3)
              Actualizado con el Ejercicio Propuesto 1
            -->
            <section id="ejercicio-2">
                <h2>Ejercicio 1: Consolidación en una Sola Hoja (Dificultad: Baja)</h2>
                
                <p>
                    El objetivo de este ejercicio es modificar el flujo guiado para consolidar todos los datos en una única hoja de Google Sheets, además de las hojas individuales. Después del nodo <code>Merge</code> (que unifica las tres ramas), se añade un nuevo nodo <code>Edit Fields (Set)</code>. Este nodo se encarga de añadir dos nuevos campos a cada ítem: <code>categoria_original</code> (mapeando el valor de <code>category</code>) y <code>Fecha de Procesamiento</code> (usando una expresión de n8n para obtener la fecha y hora actual).
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/UL6iPVf.png" 
                     alt="Captura de pantalla del Nodo Set para consolidar">

                <p>
                    Finalmente, se añade un último nodo <code>Google Sheets (Append)</code> conectado a la salida del nuevo <code>Edit Fields (Set)</code>. Este nodo se configura para escribir en una nueva hoja llamada "Todos". En su configuración, se mapean las columnas <code>ID</code>, <code>Chiste</code>, <code>Fecha de Procesamiento</code> y <code>categoria_original</code>. El flujo resultante ahora no solo clasifica los chistes en hojas separadas, sino que también mantiene un registro consolidado de todos los chistes procesados.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/ZMI75Lq.png" 
                     alt="Captura de pantalla del workflow resultante con la hoja 'Todos'">
            </section>

            <!-- 
              SECCIÓN DE EJERCICIO 3 (Práctica 3)
              Actualizado con el Ejercicio Propuesto 2
            -->
            <section id="ejercicio-3">
                <h2>Ejercicio 2: Clasificación de Productos por Valoración (Dificultad: Media)</h2>
                
                <p>
                    Este ejercicio requería clasificar productos de la "Fake Store API" según su valoración (rating). Después de obtener los datos y usar <code>Split Out</code>, se implementó un nodo <code>Switch</code>. Este nodo se configuró con tres salidas basadas en el campo <code>rating.rate</code>:
                </p>
                <ul>
                    <li><b>Salida 0 ("Top"):</b> Valoración >= 4.5</li>
                    <li><b>Salida 1 ("Bueno"):</b> Valoración >= 3.5 y < 4.5</li>
                    <li><b>Salida 2 ("Regular"):</b> Valoración < 3.5</li>
                </ul>
                <img class="screenshot" 
                     src="https://i.imgur.com/bjnJOX1.png" 
                     alt="Captura de pantalla del Nodo Switch para valoración">

                <p>
                    Cada salida del nodo <code>Switch</code> se conectó a un nodo <code>Google Sheets (Append)</code> distinto. Cada uno de estos nodos se configuró para escribir en una hoja separada ("Top", "Bueno", "Regular") dentro del mismo documento. Se mapearon las columnas <code>ID</code>, <code>Título</code> (mapeado desde <code>title</code>), <code>Precio</code> (mapeado desde <code>price</code>) y <code>Valoración</code> (mapeado desde <code>rating.rate</code>).
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/jnc7n2I.png" 
                     alt="Captura de pantalla de los nodos de Google Sheets por valoración">

                <p>
                    El resultado en Google Sheets muestra cómo los productos han sido correctamente clasificados y almacenados en sus respectivas hojas, validando la lógica del <code>Switch</code>.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/KXoxUhH.png" 
                     alt="Captura de pantalla del resultado en Google Sheets">
                
                <p>
                    La captura final del flujo de trabajo muestra la ejecución completa, donde se observa el paso de los ítems por el <code>Split Out</code>, su clasificación en el <code>Switch</code> y el procesamiento final en los tres nodos de Google Sheets.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/z9i8jYy.png" 
                     alt="Captura de pantalla del workflow resultante">
            </section>

            <!-- 
              SECCIÓN DE EJERCICIO 4 (Práctica 3)
              Actualizado con el Ejercicio Propuesto 3
            -->
            <section id="ejercicio-4">
                <h2>Ejercicio 3: Gestor de Tareas por Prioridad (Dificultad: Alta)</h2>
                
                <p>
                    Este ejercicio simulaba un gestor de tareas avanzado. El flujo se inicia con un <code>Manual Trigger</code> y pasa a 5 nodos <code>HTTPS</code>. Este nodo es el corazón de la simulación: se ejecuta 5 veces  y en cada iteración. En <code>Code</code>, asigna aleatoriamente una <code>priority</code> ("Alta", "Media", "Baja") y un <code>type</code> ("Técnico", "Marketing", "Administrativo") a cada tarea.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/v82tG3d.png" 
                     alt="Captura de pantalla del Nodo Code para simular tareas">

                <p>
                    A continuación, un nodo <code>Switch</code> enruta cada una de las 5 tareas basándose en el campo <code>priority</code> que se les asignó aleatoriamente. Se crean tres ramas de salida: "Alta", "Media" y "Baja".
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/vqyRCHA.png" 
                     alt="Captura de pantalla del Nodo Switch por prioridad">

                <p>
                    (Aunque no se muestra una captura explícita de los nodos intermedios, se asume que cada rama procesa la tarea de alguna manera, por ejemplo, escribiendo en hojas de "Tareas_Alta", "Tareas_Media", "Tareas_Baja" como en ejercicios anteriores).
                </p>
                <p>
                    Después de que las tareas han sido procesadas en sus respectivas ramas, un nodo <code>Merge</code> reúne las tres ramas de ejecución ("Alta", "Media", "Baja") de nuevo en un solo flujo.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/GYcXAIC.png" 
                     alt="Captura de pantalla del Nodo Merge para unir ramas">

                <p>
                    Finalmente, después del <code>Merge</code>, un único nodo <code>Google Sheets (Append)</code> se encarga de registrar todas las tareas procesadas, sin importar su prioridad, en una hoja de log general llamada "Registro_General". Este nodo mapea la <code>activity</code>, <code>priority</code>, <code>type</code> y una <code>hora_asignacion</code> (generada con una expresión) para mantener un registro centralizado.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/xuaMKR9.png" 
                     alt="Captura de pantalla del Google Sheet 'Registro_General'">

                <p>
                    La captura final muestra el flujo de trabajo completo, con la lógica de simulación, enrutamiento por prioridad, fusión de ramas y el registro final en una hoja de Google Sheets.
                </p>
                <img class="screenshot" 
                     src="https://i.imgur.com/4MyEhsi.png" 
                     alt="Captura de pantalla del workflow final del Ejercicio 3">
            </section>


        </main>
    </div>

</body>
</html>